<!DOCTYPE html>
<html>
    <head>
        <title> Carol's Website</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <meta name="viewport" content="width=device-width,initial-scale=1" />
        <meta name="description" content="Carol's Website">
        <link rel="icon" type="image" href="Test/image/flower 4.png">
        <meta property="og:url"  content="https://github.com/Mary4721/Test.git" />
        <meta property="og:type"   content="website" />
        <meta property="og:title"   content="Kittitian living in Bim" />
        <meta property="og:description"  content="Tips on living in Barbados Description" />
        <meta property="og:image" content="https://github.com/Mary4721/Test/image/flower 4.png" />
        <meta name="location" content="Barbados">
        <meta name="Author" content="Carol">
        <meta name="Subject" content="Tips on Moving to Barbados">
        <meta name="Language" content="English">
        <meta name="Abstract" content="Moving to Barbados">
        <meta name="Copyright" content="Copyright 2021 by Carol. All rights reversed.">
        <meta name="Designer" content="Carol">
        <meta name="Publisher" content="Carol">
        <meta name="Distribution" content="Global">
        <link rel="canonical" href="https://github.com/Mary4721/Test.git">
        <link rel="stylesheet" href="Test/css/style.min.css">
        <link rel="dns-prefetch" href="http://www.expatfocus.com/barbados/moving/how-to-move-to-barbados/">
        <link rel="dns-prefetch" href="https://github.com/Mary4721/Test/project.html">

        <link href="https://fonts.googleapis.com/css?family=Material+Icons|Material+Icons+Outlined|Material+Icons+Two+Tone|Material+Icons+Round|Material+Icons+Sharp" rel="stylesheet">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
        <script type="application/ld+json">
            {
              "@context" : "http://schema.org",
              "@type" : "Product",
              "image" : "https://github.com/Mary4721/Test/images/flower 2.png"
            }
        </script>
        <script defer src="js/script.min.js"></script>
        <script defer src="js/script_index.min.js"></script>
    </head>
    <body>
        <header>
           <div class="logo-section">
                <a href="index.html"><img src="image/flower 4.png"/></a>
                <p class="d-none d-sm-block"> Tips on Living in Barbados </p>
                <form>
                    <input type="search" name="search" placeholder="Search"/>
                    <input type="submit" value="search" class="material-icons"/>
                    <div class="search-autocomplete display-none">
                        <ul>
                            <li>suggestion keyword</li>
                        </ul>
                    </div>
                </form>
                <p>
                    <a id="contact" href="contact.html">
                        <span class="d-none d-sm-inline-block">Contact Me </span>
                        <span class="material-icons">mail</span>
                    </a>
                </p>
                <!--Button trigger modal-->
                <p id="login-or-user-info">
                    <button type="button" class="btn btn-primary btn-login" data-bs-toggle="modal" data-bs-target="#loginModal">LOGIN</button>
                </p>
            </div>
            <!--Modal-->
            <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="loginModalLabel"> LOGIN</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="close"></button>
                        </div>
                        <div class="modal-body">
                            <form class="modal-form flex-fill d-flex flex-column align-item-c-enter" role="form" method="POST">
                                <input type="hidden" name="_token" value>
                                <div class="form-group col-6 email-group">
                                    <label class="control-label" for="email">E-mail Address</label>
                                    <input type="email" class="form-control form-control-lg" id="email" name="email" placeholder="Enter Email" required>
                                </div>
                                <div class="form-group col-6 password-group">
                                    <label class="control-label" for="password"> Password</label>
                                    <input type="password" class="form-control form-control-lg"
                                    id="password" name="password" placeholder="Enter Password" required>
                                </div>
                                <div class="form-group col-6 submit-group">
                                    <button type="submit" class="btn btn-sucess mt-4 col-12"> login </button>
                                </div>
                            </form>
                            <p class="modal-notice text-center">Do you have an account?
                                <a href="javascript:void(0)" onclick="showSignUpForm()">Sign Up </a>
                                Here!
                            </p>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        </div>
                    </div>
                </div>
            </div>
            <script>
               if($.cookie("user_name") && $.cookie("user_name") !== null) {
        changeToUserInfoIcon();
      }

      function changeToUserInfoIcon() {
        $('#login-or-user-info').html(`<a href="javascript:void(0)" onclick="logout()"><span class="material-icons-outlined">face</span></a>`);
      }

      const loginModal = new bootstrap.Modal(document.getElementById('loginModal'));
      $('.modal-form').on('submit', function(){
          event.preventDefault();
          
          if($('.modal-dialog .modal-title').text() === "LOGIN") {
             firebase.auth().signInWithEmailAndPassword($('.modal-form #email').val(), $('.modal-form #password').val())
            .then((userCredential) => {
                console.log(userCredential);
                loginModal.hide();
                $.cookie("user_name", userCredential.user.displayName ? userCredential.user.displayName : userCredential.user.email);
                $.cookie("user_email", userCredential.user.email);
                $.cookie("uid", userCredential.user.uid);
                location.reload();
            })
            .catch((error) => {
                console.log(error);
                alert('login failed!');
                loginModal.hide();
            }); 
          } else {
            if($('.modal-form #password').val() !== $('.modal-form #confirm-password').val()){
                return alert('password and confirm password is not the same');
            }
            firebase.auth().createUserWithEmailAndPassword($('.modal-form #email').val(), $('.modal-form #password').val())
            .then(function(result) {
                alert('Sign up succeeded! Please sign in again!');
                loginModal.hide();
                return result.user.updateProfile({
                    displayName: $('.modal-form #name').val()
                })
            }).catch(function(error) {
                console.log(error);
                alert('Sign up failed!');
                loginModal.hide();
            });
          }
      })

      function showSignUpForm(){
        $('.modal-dialog .modal-title').text('CREATE ACCOUNT');

        $(`<div class="form-group col-6 name-group">
          <label class="control-label" for="name">Name</label>
          <input type="text" class="form-control form-control-lg" id="name" name="name" placeholder="Enter Name" required>
        </div>`).insertBefore( ".modal-dialog .email-group" );

        $(`<div class="form-group col-6 confirm-password-group">
          <label class="control-label" for="confirm-password">Confirm Password</label>
          <input type="password" class="form-control form-control-lg" id="confirm-password" name="confirm-password" placeholder="Enter Password Again" required>
        </div>`).insertAfter( ".modal-dialog .password-group" );

        $('.modal-dialog .submit-group button').text('Create Account');
        $('.modal-dialog .modal-notice').html(`Back to <a href="javascript:void(0)" onclick="showSignInForm()">Sign in</a>`)
      }

      function showSignInForm() {
        $('.modal-dialog .modal-title').text('LOGIN');
        $('.modal-dialog .name-group').remove();
        $('.modal-dialog .confirm-password-group').remove();
        $('.modal-dialog .submit-group button').text('Login');
        $('.modal-dialog .modal-notice').html(`Do you have account? <a href="javascript:void(0)" onclick="showSignUpForm()">Sign up</a> here!`)
      }

      function logout() {
        let isLogout = confirm("Are you sure you want to logout?");
        isLogout &&
            firebase.auth().signOut().then(() => {
                $.removeCookie("uid");
                $.removeCookie("user_name");
                $.removeCookie("user_email");
                location.reload();
            }).catch((error) => {
                console.log(error);
                alert('Logout failed!');
            });
      }  
            </script> 
        </header>
        <nav>
           <ul>
                <li class="btn-main">
                    <a href="index.html">Home</a>
                </li>
                <li class="btn-main" onmouseover="mouseover_on_nav_item(this)" onmouseout="mouseout_on_nav_item(this)">
                    <a href="preparation.html">Preparation</a>
                    <div class="nav-submenu" onmouseover="mouseover_on_nav_item(this)">
                        <ul>
                            <li>
                                <span class="material-icons-outlined">person</span>
                                <a href="preparation.html#Ivan1">Ivan one</a>
                            </li>
                            <li>
                                <span class="material-icons-outlined">person</span>
                                <a href="team.html#Ivan2">Ivan two</a>
                            </li>
                            <li>
                                <span class="material-icons-outlined">person</span>
                                <a href="preparation.html#Ivan3">Ivan three</a>
                            </li>
                        </ul>
                    </div>
                </li>
                <li class="btn-main" onmouseover="mouseover_on_nav_item(this)" onmouseout="mouseout_on_nav_item(this)">
                    <a href="#">Immigration</a>
                    <div class="nav-submenu" onmouseover="mouseover_on_nav_item(this)">
                        <ul>
                            <li>
                                <span class="material-icons-outlined">task</span>
                                <a href="https://immigration.gov.bb/"> Barbados Immigration Department</a>
                            </li>
                            <li>
                                <span class="material-icons-outlined">task</span>
                                <a href="https://csme.caricom.org/">Caricom Skilled Certificate</a>
                            </li>
                            <li>
                                <span class="material-icons-outlined">task</span>
                                <a href="immigration.html">Embassies</a>
                            </li>
                        </ul>
                    </div>
                </li>
                <li class="btn-main">
                    <a href="about.html">Activities</a>
                </li>
            </ul> 
        </nav>
        <main>
            <div class="main-image slider">
                <img alt="slider-image" src="Test/images/beach 1.jpg" class="slider-item"/>
                <img alt="slider-image" src="Test/images/beach 2.jpg" class="slider-item"/>
                <img alt="slider-image" src="Test/images/beach 3.jpg" class="slider-item"/>
                <img alt="slider-image" src="Test/images/lion.jpg" class="slider-item"/>
                <img alt="slider-image" src="Test/images/pond.jpg" class="slider-item"/>
                <button class="slider-prev" onclick="prevImage()"><</button>
                <button class="slider-next" onclick="nextImage()">></button>
                <button class="slider-bingo spin" onclick="bingo()">SPIN</button>
            </div>
            <div class="main-content">
                <section>
                    <h1 class="d-none">Pre-visit Advice</h1>
                    <article>
                        <h2>Accommodation and Transport</h2>
                        <p>
                            Barbados offers a variety of accommodations to fit the requirements and budget of visitors on either short term or long term stay. Most persons from the neighbouring islands who come to the American Embassy tend to stay in hotels along the South Coast, while those who come for medical care at the Queen Elizabeth Hospital stay in St. Michael. There are Airbnb vacation rental properties that widens options of locations outside the regular torist belt.  :
                        </p>
                        <div id="items-layout" class="items-layout"></div>
                    </article>
                    <article>
                        <h2> Immigration </h2>
                        <p>
                            Caribbean Community (Caricom nationals), except citizens of Haiti under the Revised Treaty of Chaguaramas, have the right to enter another Caricom country for an automatic 6 month stay. Entry can be refused if the person is deemed undersirable or can become a charge on the public purse. 

                            Visitors need a valid passport and proof adequate means of fincial support for the time in Barbados.

                            Persons need to have a negative PCR test before entering Barbados, there is no vaccination requirement as of 29 July 2021. Quaratine 

                            Extension of stay should be made to the Immigration Department before the return date. Visitors are not allowed to work unless a work permit has been granted. Caricom nationals who meet the requirements can apply to the Accreditation Council for a Skilled National Certificate.
                        </p>
                    </article>
                    <article>
                        <h3> Fun Things to Do </h3>
                        <p>
                            Sun, Sea, Sand has never been so sweet until you've experience it in Barbados. Here are a few fun Things

                            <strong>Beach </strong>
                            
                            Yes, every Caribbean island would claim to have the best beaches but Barbados has long stretches of yellow sand beaches and clear water that invites you to come in. Brown's Beach is by far the best. There are lots to do at the beach: jet ski; water slides; glass bottom boats, submarine tours, dive, surf, windsurf or kitesurf 

                            <strong> Historical Train Ride </strong>
                            Visit St. Nicholas Abbey and see how they make rum then go for a short train ride in the north of the island. While in the north visit the sea creature of the Animal Flower Cave. History will come alive in the many museums but not like they do at the Caribbean Wax Museum where you can meet Rihanna, Usain Bolt and soca queen Alison Hinds.
                
                        </p>
                    </article>
                </section>
                <aside>
                    <div class="d-none d-sm-block col-12 col-sm-10 col-md-8 col-lg-6 float-end">
                        <h3>Fun facts about Barbados</h3>
                        <ul>
                            <li>The island was a coral reef</li>
                            <li>Rihanna was born in Westbury Street</li>
                            <li>Flying fish do not fly</li>
                        </ul>
                    </div>
                </aside>
            </div>
        </main>
        <footer>
         <p>©Copyright 2021 by Carol. All rights reversed.</p>     
        </footer>        
    </body>
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/8.7.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.7.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.7.1/firebase-database.js"></script>
    <!-- TODO: Add SDKs for Firebase products that you want to use
        https://firebase.google.com/docs/web/setup#available-libraries -->
    <script src="https://www.gstatic.com/firebasejs/8.7.1/firebase-analytics.js"></script>

    <script>
        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        var firebaseConfig = {
            apiKey: "AIzaSyBi1TivKJ0aAsuoCh1pDEqHvu22YvKiGdY",
            authDomain: "contact-form-ed774.firebaseapp.com",
            databaseURL: "https://contact-form-ed774-default-rtdb.firebaseio.com",
            projectId: "contact-form-ed774",
            storageBucket: "contact-form-ed774.appspot.com",
            messagingSenderId: "3376266719",
            appId: "1:3376266719:web:ef951163f4174b5626d86a",
            measurementId: "G-DENRXVS6SX"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        firebase.analytics();
    </script>    
    <script>
        let colorCategorySet = new Set();

        let currentPage = 1;
        let totalPage = 0;
        let totalItems = [];
        let currentColorFilter = "All";
        const numbersOfItemsInOnePage = 6;
        const items_layout = document.querySelector('#items-layout');

        function renderItems(items) {
            items_layout.innerHTML = '<div id="filter-division" class="filter-division"></div>'
            totalPage = Math.floor((items.length-1) / numbersOfItemsInOnePage) + 1
            items.forEach((item)=>{
                colorCategorySet.add(item.color);
            })

            const itemsOfPage = items.slice(numbersOfItemsInOnePage*(currentPage-1), numbersOfItemsInOnePage*currentPage);

            renderPagination("first-paginaion")

            itemsOfPage.forEach(function (item) {
                let item_html = "";
                item_html += '<div class="item">';
                item_html += '<div class="item-title">' + item.name + '</div>';
                item_html += '<div class="item-body">';
                item_html += '<div class="item-image"><img src="' + item.image_link + '"" /></div>';
                item_html += '</div>';
                item_html += '<div class="item-footer">'
                item_html += '<div class="item-attribute"><span>' + item.color.toUpperCase() + '</span><span> ' + item.description.toUpperCase() + '</span></div>';
                item_html += '<div>$' + item.price + '</div>';
                item_html += '</div>';
                item_html += '</div>';

                items_layout.innerHTML += item_html;
            })

            renderDataFilter()
            renderPagination()

            const elements = document.getElementsByClassName("item");
            for (let index = 0; index < elements.length; index++) {
                elements[index].onclick = function () {
                    alert(this.querySelector('.item-title').innerText);
                }
            }

            //location.href ="#items-layout";
        }

        function rerenderItemsByPage(page){
            currentPage = page;
            renderItems(totalItems);
        }

        function renderPagination(elementID="none") {
            items_layout.innerHTML += 
                        `<div id="${elementID}" class="pagination-division">
                            <ul class="pagination-element">
                                <li ${currentPage === 1 ? '': `onclick="rerenderItemsByPage(1)"`}><<</li>
                                <li ${currentPage === 1 ? '': `onclick="rerenderItemsByPage(${currentPage-1})"`} ><</li>
                                ${renderNumbersListOfPagination() }
                                <li ${currentPage === totalPage ? '': `onclick="rerenderItemsByPage(${currentPage+1})"`} >></li>
                                <li ${currentPage === totalPage ? '': `onclick="rerenderItemsByPage(${totalPage})"`} >>></li>
                            </ul>
                        </div>`
        }

        function renderNumbersListOfPagination () {
            let number_array = new Array(totalPage);
            for (let index=0; index<totalPage; index++) {
                number_array[index] = index+1;
            }
            return number_array.reduce((accumulator, currentValue)=> {
                return accumulator += `<li ${(currentPage === currentValue) ? 'class="active"':  `onclick="rerenderItemsByPage(${currentValue})"`} >${currentValue}</li>`
            }, "")
        }

        function rerenderItemsByColorFilter(color) {
            currentColorFilter = color;
            let filterItems = (currentColorFilter === "All") ? totalItems : totalItems.filter((item)=>{
                return item.color === color;
            })
            currentPage = 1;
            renderItems(filterItems);
        }

        function renderDataFilter() {
            const colorCategoryArray = Array.from(colorCategorySet)
            items_layout.innerHTML +=
                `<div id="filter-element" class="filter-element">
                    <span>Color:</span>
                    <select onchange="rerenderItemsByColorFilter(this.options[this.selectedIndex].value);">
                        <option value="All">All</option>
                        ${ colorCategoryArray.reduce((accumulator, currentValue, currentIndex)=>{
                            return accumulator += `<option value="${currentValue}" ${currentColorFilter === currentValue ? "selected":""}>${currentValue}</option>`
                        }, "")}
                    </select>
                </div>`
            document.getElementById('filter-division').appendChild(document.getElementById('filter-element'));
        }

        function readCSVFile(file) {
            fetch(file).then(function (response) {
                return response.text()
            }).then(function (data) {
                let items = []
                const header_string = data.split(/\n/)[0];
                const dataTable = data.split(/\n/).slice(1);
                dataTable.forEach(function (row) {
                    const headers = header_string.split(',');
                    const columns = row.split(',');
                    let item = {}
                    columns.forEach((col, index) => {
                        if (col) {
                            const key = headers[index].replace(/(\r\n|\n|\r)/gm, "");
                            item[key] = col.replace(/(\r\n|\n|\r)/gm, "");
                        }
                    })

                    items.push(item);
                })

                renderItems(items);
            })
        }

        function readJSONFile(file) {
            /*fetch(file).then(response => {
                return response.json();
            }).then(data => {
                totalItems = data.items;
                renderItems(totalItems);
            });*/
            $.get('https://contact-form-ed774-default-rtdb.firebaseio.com/items/.json',
            null,
                function (res) {
                    totalItems = Object.values(res);
                    renderItems(totalItems);
                }
            );
        }

        readJSONFile("seeders/data.json");

        $(document).ready(function() {
            /*if(!$.cookie("user_name") || $.cookie("user_name") === null) {
                let name = prompt("What is your name?", "Type your name here");
                $.cookie("user_name", name);
            }*/
        })
    </script>
</html>
